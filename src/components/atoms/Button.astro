---
// Button component
import Icon from '@/components/atoms/Icon.astro';

interface Props {
  style: 'primary' | 'secondary' | 'tertiary';
  href?: string;
  anchor?: string;
  target?: string;
}

const { style, href, anchor, target = '_self' } = Astro.props;

const baseClass = 'group inline-flex items-center transition-all hover:cursor-pointer';

const styleClass =
  style === 'primary'
    ? 'justify-center px-8 py-3.5 rounded-full bg-primary text-white dark:bg-white dark:text-black font-medium transform hover:-translate-y-1'
    : style === 'secondary'
      ? 'justify-center px-8 py-3.5 rounded-full bg-secondary text-primary font-medium transform hover:-translate-y-1'
      : 'gap-2 font-semibold border-b-2 border-primary dark:border-white pb-1 hover:text-quaternary dark:hover:text-gray-300 hover:border-quaternary dark:hover:border-gray-300';

const buttonClass = `${baseClass} ${styleClass}`;
---

{
  href ? (
    <a
      class={buttonClass}
      href={href}
      target={target}
      {...(target === '_blank' && { rel: 'noopener noreferrer' })}
    >
      <slot />
      {style === 'tertiary' && (
        <Icon
          name="arrow_right_alt"
          class="text-xl transition-transform group-hover:translate-x-1"
          width="24"
          height="24"
        />
      )}
    </a>
  ) : (
    <button class={buttonClass} data-anchor={anchor} type="button">
      <slot />
      {style === 'tertiary' && (
        <Icon
          name="arrow_right_alt"
          class="text-xl transition-transform group-hover:translate-x-1"
          width="24"
          height="24"
        />
      )}
    </button>
  )
}

<script>
  // Efficient smooth scroll with minimal performance impact
  document.addEventListener(
    'click',
    (e) => {
      const target = e.target as HTMLElement;
      const button = target.closest('button[data-anchor]') as HTMLButtonElement;

      if (button?.dataset.anchor) {
        e.preventDefault();
        const section = document.getElementById(button.dataset.anchor);
        if (section) {
          section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }
    },
    { passive: false }
  );
</script>
